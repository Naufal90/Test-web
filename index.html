<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Login/Register Supabase</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
    <script>
        eruda.init();
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        input, button {
            margin: 5px;
            padding: 10px;
        }
        #console-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px;
            background: red;
            color: white;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <h1>Test Login/Register Supabase</h1>

    <!-- Form Register -->
    <h2>Register</h2>
    <input type="email" id="register-email" placeholder="Email">
    <input type="password" id="register-password" placeholder="Password">
    <button onclick="register()">Daftar</button>
    <p id="register-message"></p>

    <!-- Form Login -->
    <h2>Login</h2>
    <input type="email" id="login-email" placeholder="Email">
    <input type="password" id="login-password" placeholder="Password">
    <button onclick="login()">Masuk</button>
    <p id="login-message"></p>

    <!-- Logout -->
    <h2>Logout</h2>
    <button onclick="logout()">Keluar</button>
    <p id="logout-message"></p>

    <!-- Tombol untuk membuka console di Android -->
    <button id="console-btn">Buka Console</button>

    <script>
        // Konfigurasi Supabase
        const SUPABASE_URL = "https://iafrlxyoeostvhnoywnv.supabase.co"; // Ganti dengan URL Supabase kamu
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhZnJseHlvZW9zdHZobm95d252Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg1MzMwNjAsImV4cCI6MjA1NDEwOTA2MH0.WEdZeif209ew2iEWsGs9Y10529hDFI9BVdFvz_7Yeno"; // Ganti dengan API Key Supabase kamu
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Fungsi Register
        async function register() {
            const email = document.getElementById("register-email").value;
            const password = document.getElementById("register-password").value;

            console.log("[DEBUG] Mencoba register dengan email:", email);
            
            const { data, error } = await supabase.auth.signUp({ email, password });

            if (error) {
                console.error("[ERROR] Register gagal:", error.message);
                document.getElementById("register-message").textContent = "Register gagal: " + error.message;
            } else {
                console.log("[DEBUG] Register berhasil:", data);
                document.getElementById("register-message").textContent = "Register berhasil! Cek email untuk verifikasi.";
            }
        }

        // Fungsi Login
        async function login() {
            const email = document.getElementById("login-email").value;
            const password = document.getElementById("login-password").value;

            console.log("[DEBUG] Mencoba login dengan email:", email);
            
            const { data, error } = await supabase.auth.signInWithPassword({ email, password });

            if (error) {
                console.error("[ERROR] Login gagal:", error.message);
                document.getElementById("login-message").textContent = "Login gagal: " + error.message;
            } else {
                console.log("[DEBUG] Login berhasil:", data);
                document.getElementById("login-message").textContent = "Login berhasil! Selamat datang.";
            }
        }

        // Fungsi Logout
        async function logout() {
            console.log("[DEBUG] Mencoba logout...");
            const { error } = await supabase.auth.signOut();

            if (error) {
                console.error("[ERROR] Logout gagal:", error.message);
                document.getElementById("logout-message").textContent = "Logout gagal: " + error.message;
            } else {
                console.log("[DEBUG] Logout berhasil!");
                document.getElementById("logout-message").textContent = "Logout berhasil!";
            }
        }

        // Fungsi untuk membuka console di Android
        document.getElementById("console-btn").addEventListener("click", function() {
            const script = document.createElement("script");
            script.src = "https://cdn.jsdelivr.net/npm/eruda";
            document.body.appendChild(script);
            script.onload = function() {
                eruda.init();
                console.log("[DEBUG] Console F12 aktif!");
            };
        });

        // Debug: Cek apakah Supabase berhasil terhubung
        document.addEventListener("DOMContentLoaded", async () => {
            const { data, error } = await supabase.auth.getUser();
            if (error) {
                console.error("[ERROR] Gagal mendapatkan user:", error.message);
            } else {
                console.log("[DEBUG] User saat ini:", data);
            }
        });
    </script>

</body>
</html>
